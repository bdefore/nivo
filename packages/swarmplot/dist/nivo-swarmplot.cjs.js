"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),o=require("@nivo/core"),t=require("@nivo/axes"),r=require("@nivo/voronoi"),i=require("@nivo/tooltip"),n=require("react/jsx-runtime"),a=require("@nivo/colors"),u=require("@nivo/annotations"),l=require("lodash/isNumber"),s=require("lodash/isPlainObject"),c=require("lodash/isString"),d=require("lodash/get"),v=require("d3-scale"),h=require("d3-force"),f=require("@nivo/scales"),g=require("@react-spring/web");function p(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}function m(e){if(e&&e.__esModule)return e;var o=Object.create(null);return e&&Object.keys(e).forEach((function(t){if("default"!==t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(o,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}})),o.default=e,Object.freeze(o)}var x=m(e),y=p(l),S=p(s),M=p(c),C=p(d);function b(){return b=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var t=arguments[o];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])}return e},b.apply(this,arguments)}function w(e,o){if(null==e)return{};var t,r,i={},n=Object.keys(e);for(r=0;r<n.length;r++)t=n[r],o.indexOf(t)>=0||(i[t]=e[t]);return i}var k,I=function(e){var o=e.id,t=e.formattedValue,r=e.color;return n.jsx(i.BasicTooltip,{id:o,value:t,enableChip:!0,color:r})},W={id:"id",value:"value",valueScale:{type:"linear",min:0,max:"auto"},groupBy:"group",size:6,spacing:2,layout:"vertical",gap:0,forceStrength:1,simulationIterations:120,colors:{scheme:"nivo"},colorBy:"group",borderWidth:0,borderColor:"rgba(0, 0, 0, 0)",layers:["grid","axes","circles","annotations","mesh"],enableGridX:!0,enableGridY:!0,axisTop:{},axisRight:{},axisBottom:{},axisLeft:{},isInteractive:!0,useMesh:!1,debugMesh:!1,tooltip:I,animate:!0,motionConfig:"gentle",annotations:[],role:"img",pixelRatio:"undefined"!=typeof window&&null!=(k=window.devicePixelRatio)?k:1},j=function(e){var o=e.width,t=e.height,r=e.axis,i=e.groups,n=e.gap;if(!Array.isArray(i)||0===i.length)throw new Error("'groups' should be an array containing at least one item");var a,u=i.length;"x"===r?a=(t-n*(u-1))/u:"y"===r&&(a=(o-n*(u-1))/u);var l=i.map((function(e,o){return o*(a+n)+a/2}));return v.scaleOrdinal(l).domain(i)},z=function(e){var o=e.width,t=e.height,r=e.axis,i=e.getValue,n=e.scale,a=e.data.map(i);if("time"===n.type){var u=[{data:a.map((function(e){var o;return{data:(o={x:null,y:null},o[r]=e,o)}}))}],l=f.generateSeriesAxis(u,r,n);return f.computeScale(n,l,"x"===r?o:t,r)}var s=Math.min.apply(Math,a),c=Math.max.apply(Math,a);return f.computeScale(n,{all:a,min:s,max:c},"x"===r?o:t,r)},E=function(e){if("function"==typeof e)return e;if(y.default(e))return function(){return e};if(S.default(e)){if(!M.default(e.key))throw new Error("Size is invalid, key should be a string pointing to the property to use to determine node size");if(!Array.isArray(e.values)||2!==e.values.length)throw new Error("Size is invalid, values spec should be an array containing two values, min and max");if(!Array.isArray(e.sizes)||2!==e.sizes.length)throw new Error("Size is invalid, sizes spec should be an array containing two values, min and max");var o=v.scaleLinear().domain([e.values[0],e.values[1]]).range([e.sizes[0],e.sizes[1]]);return function(t){return o(C.default(t,e.key))}}throw new Error("Size is invalid, it should be either a function, a number or an object")},B=function(e){var o,t,r=e.axis,i=e.valueScale,n=e.ordinalScale,a=e.spacing,u=e.forceStrength,l=h.forceCollide((function(e){return e.size/2+a/2}));if("x"===r)o=h.forceX((function(e){return i(e.value)})).strength(u),t=h.forceY((function(e){return n(e.group)}));else{if("y"!==r)throw new Error("Invalid axis provided: "+r);o=h.forceX((function(e){return n(e.group)})),t=h.forceY((function(e){return i(e.value)})).strength(u)}return{x:o,y:t,collision:l}},T=function(e){var o,t,r=e.data,i=e.getId,n=e.layout,a=e.getValue,u=e.valueScale,l=e.getGroup,s=e.ordinalScale,c=e.getSize,d=e.forces,v=e.simulationIterations,g=e.valueScaleConfig,p={horizontal:["x","y"],vertical:["y","x"]},m="time"===(t=g).type&&"native"!==t.format?f.createDateNormalizer(t):function(e){return e},x=r.map((function(e){return{id:i(e),group:l(e),value:m(a(e)),size:c(e),data:b({},e)}})),y=h.forceSimulation(x).force("x",d.x).force("y",d.y).force("collide",d.collision).stop();return y.tick(v),(o={})[p[n][0]+"Scale"]=u,o[p[n][1]+"Scale"]=s,o.nodes=y.nodes(),o},P=function(o){var t=o.width,r=o.height,i=o.axis,n=o.getValue,a=o.scale,u=o.data;return e.useMemo((function(){return z({width:t,height:r,axis:i,getValue:n,scale:a,data:u})}),[t,r,i,n,a,u])},L=function(o){var t=o.width,r=o.height,i=o.axis,n=o.groups,a=o.gap;return e.useMemo((function(){return j({width:t,height:r,axis:i,groups:n,gap:a})}),[t,r,i,n,a])},V=function(o){var t=o.axis,r=o.valueScale,i=o.ordinalScale,n=o.spacing,a=o.forceStrength;return e.useMemo((function(){return B({axis:t,valueScale:r,ordinalScale:i,spacing:n,forceStrength:a})}),[t,r,i,n,a])},O=function(t){var r=t.data,i=t.width,n=t.height,u=t.id,l=t.value,s=t.valueFormat,c=t.valueScale,d=t.groups,v=t.groupBy,h=t.size,f=t.spacing,g=t.layout,p=t.gap,m=t.forceStrength,x=t.simulationIterations,y=t.colors,S=t.colorBy,M="horizontal"===g?"x":"y",C=o.usePropertyAccessor(u),w=o.usePropertyAccessor(l),k=o.useValueFormatter(s),I=o.usePropertyAccessor(v),W=function(o){return e.useMemo((function(){return E(o)}),[o])}(h),j=o.usePropertyAccessor(S),z=a.useOrdinalColorScale(y,j),B=P({width:i,height:n,axis:M,getValue:w,scale:c,data:r}),O=L({width:i,height:n,axis:M,groups:d,gap:p}),R=V({axis:M,valueScale:B,ordinalScale:O,spacing:f,forceStrength:m}),q=e.useMemo((function(){return T({data:r,getId:C,layout:g,getValue:w,valueScale:B,getGroup:I,ordinalScale:O,getSize:W,forces:R,simulationIterations:x,valueScaleConfig:c})}),[r,C,g,w,B,I,O,W,R,x,c]),A=q.nodes,F=q.xScale,G=q.yScale;return{nodes:e.useMemo((function(){return A.map((function(e){return b({},e,{formattedValue:k(e.value),color:z(e)})}))}),[A,k,z]),xScale:F,yScale:G,getColor:z}},R=function(o){return e.useMemo((function(){return"function"==typeof o?o:function(){return o}}),[o])},q=function(o){var t=o.isInteractive,r=o.onClick,n=o.onMouseEnter,a=o.onMouseLeave,u=o.onMouseMove,l=o.tooltip,s=i.useTooltip(),c=s.showTooltipFromEvent,d=s.hideTooltip;return{onMouseEnter:e.useCallback((function(e,o){t&&(c(l(e),o),null==n||n(e,o))}),[t,n,c,l]),onMouseMove:e.useCallback((function(e,o){t&&(c(l(e),o),null==u||u(e,o))}),[t,u,c,l]),onMouseLeave:e.useCallback((function(e,o){t&&(d(),null==a||a(e,o))}),[t,d,a]),onClick:e.useCallback((function(e,o){t&&(null==r||r(e,o))}),[t,r])}},A=function(e){return{x:e.x,y:e.y}},F=function(e){return{size:e.size,width:e.size,height:e.size}},G=function(e,o){return u.useAnnotations({data:e,annotations:o,getPosition:A,getDimensions:F})},H=function(o){var t=o.nodes,r=o.xScale,i=o.yScale,n=o.innerWidth,a=o.innerHeight,u=o.outerWidth,l=o.outerHeight,s=o.margin;return e.useMemo((function(){return{nodes:t,xScale:r,yScale:i,innerWidth:n,innerHeight:a,outerWidth:u,outerHeight:l,margin:s}}),[t,r,i,n,a,u,l,s])},X=function(t){var r=t.nodes,u=t.borderWidth,l=t.borderColor,s=t.component,c=t.isInteractive,d=t.onMouseEnter,v=t.onMouseMove,h=t.onMouseLeave,f=t.onClick,p=t.tooltip,m=i.useTooltip(),y=m.showTooltipFromEvent,S=m.hideTooltip,M=e.useMemo((function(){if(c)return function(o,t){y(e.createElement(p,o),t),null==d||d(o,t)}}),[c,y,p,d]),C=e.useMemo((function(){if(c)return function(o,t){y(e.createElement(p,o),t),null==v||v(o,t)}}),[c,y,p,v]),w=e.useMemo((function(){if(c)return function(e,o){S(),null==h||h(e,o)}}),[c,S,h]),k=e.useMemo((function(){if(c)return function(e,o){null==f||f(e,o)}}),[c,f]),I=o.useMotionConfig(),W=I.animate,j=I.config,z=o.useTheme(),E=R(u),B=a.useInheritedColor(l,z),T=e.useMemo((function(){return function(e){return{enter:function(o){return{x:o.x,y:o.y,radius:0,color:o.color,borderColor:e(o),opacity:0}},update:function(o){return{x:o.x,y:o.y,radius:o.size/2,color:o.color,borderColor:e(o),opacity:1}},leave:function(o){return{x:o.x,y:o.y,radius:0,color:o.color,borderColor:e(o),opacity:0}}}}(B)}),[B]),P=g.useTransition(r,{keys:function(e){return e.id},initial:T.update,from:T.enter,enter:T.update,update:T.update,leave:T.leave,config:j,immediate:!W});return n.jsx(n.Fragment,{children:P((function(e,o){return x.createElement(s,{key:o.id,node:o,style:b({},e,{radius:(t=e.radius,g.to([t],(function(e){return Math.max(0,e)}))),borderWidth:E(o)}),onMouseEnter:M,onMouseMove:C,onMouseLeave:w,onClick:k});var t}))})},Y=function(e){var o=e.node,t=e.style,r=e.onMouseEnter,i=e.onMouseMove,a=e.onMouseLeave,u=e.onClick;return n.jsx(g.animated.circle,{cx:t.x,cy:t.y,r:t.radius,fill:t.color,stroke:t.borderColor,strokeWidth:t.borderWidth,opacity:t.opacity,onMouseEnter:function(e){return null==r?void 0:r(o,e)},onMouseMove:function(e){return null==i?void 0:i(o,e)},onMouseLeave:function(e){return null==a?void 0:a(o,e)},onClick:function(e){return null==u?void 0:u(o,e)}},o.id)},D=function(e){var o=e.nodes,t=e.annotations,r=G(o,t);return n.jsx(n.Fragment,{children:r.map((function(e,o){return n.jsx(u.Annotation,b({},e),o)}))})},N=["nodes"],_=["theme","isInteractive","animate","motionConfig","renderWrapper"],J=function(i){var a=i.data,u=i.width,l=i.height,s=i.margin,c=i.id,d=void 0===c?W.id:c,v=i.value,h=void 0===v?W.value:v,f=i.valueScale,g=void 0===f?W.valueScale:f,p=i.valueFormat,m=i.groups,x=i.groupBy,y=void 0===x?W.groupBy:x,S=i.size,M=void 0===S?W.size:S,C=i.forceStrength,b=void 0===C?W.forceStrength:C,k=i.simulationIterations,I=void 0===k?W.simulationIterations:k,j=i.colors,z=void 0===j?W.colors:j,E=i.colorBy,B=void 0===E?W.colorBy:E,T=i.borderColor,P=void 0===T?W.borderColor:T,L=i.borderWidth,V=void 0===L?W.borderWidth:L,R=i.layout,A=void 0===R?W.layout:R,F=i.spacing,G=void 0===F?W.spacing:F,_=i.gap,J=void 0===_?W.gap:_,K=i.layers,Q=void 0===K?W.layers:K,U=i.circleComponent,Z=void 0===U?Y:U,$=i.useMesh,ee=void 0===$?W.useMesh:$,oe=i.debugMesh,te=void 0===oe?W.debugMesh:oe,re=i.enableGridX,ie=void 0===re?W.enableGridX:re,ne=i.gridXValues,ae=i.enableGridY,ue=void 0===ae?W.enableGridY:ae,le=i.gridYValues,se=i.axisTop,ce=void 0===se?W.axisTop:se,de=i.axisRight,ve=void 0===de?W.axisRight:de,he=i.axisBottom,fe=void 0===he?W.axisBottom:he,ge=i.axisLeft,pe=void 0===ge?W.axisLeft:ge,me=i.isInteractive,xe=i.onMouseEnter,ye=i.onMouseMove,Se=i.onMouseLeave,Me=i.onClick,Ce=i.tooltip,be=void 0===Ce?W.tooltip:Ce,we=i.annotations,ke=void 0===we?W.annotations:we,Ie=i.role,We=void 0===Ie?W.role:Ie,je=o.useDimensions(u,l,s),ze=je.outerWidth,Ee=je.outerHeight,Be=je.margin,Te=je.innerWidth,Pe=je.innerHeight,Le=O({width:Te,height:Pe,data:a,id:d,value:h,valueFormat:p,valueScale:g,groups:m,groupBy:y,size:M,spacing:G,layout:A,gap:J,colors:z,colorBy:B,forceStrength:b,simulationIterations:I}),Ve=Le.nodes,Oe=w(Le,N),Re=Oe.xScale,qe=Oe.yScale,Ae=q({isInteractive:me,onClick:Me,onMouseEnter:xe,onMouseLeave:Se,onMouseMove:ye,tooltip:be}),Fe={grid:null,axes:null,circles:null,annotations:null,mesh:null};Q.includes("grid")&&(Fe.grid=n.jsx(t.Grid,{width:Te,height:Pe,xScale:ie?Re:null,xValues:ne,yScale:ue?qe:null,yValues:le},"grid")),Q.includes("axes")&&(Fe.axes=n.jsx(t.Axes,{xScale:Re,yScale:qe,width:Te,height:Pe,top:null!=ce?ce:void 0,right:null!=ve?ve:void 0,bottom:null!=fe?fe:void 0,left:null!=pe?pe:void 0},"axes")),Q.includes("circles")&&(Fe.circles=n.jsx(X,{nodes:Ve,borderWidth:V,borderColor:P,isInteractive:me,tooltip:be,component:Z,onMouseEnter:xe,onMouseMove:ye,onMouseLeave:Se,onClick:Me},"circles")),Q.includes("annotations")&&(Fe.annotations=n.jsx(D,{nodes:Ve,annotations:ke},"annotations")),me&&ee&&(Fe.mesh=n.jsx(r.Mesh,{nodes:Ve,width:Te,height:Pe,onMouseEnter:Ae.onMouseEnter,onMouseMove:Ae.onMouseMove,onMouseLeave:Ae.onMouseLeave,onClick:Ae.onClick,debug:te},"mesh"));var Ge=H({nodes:Ve,xScale:Re,yScale:qe,innerWidth:Te,innerHeight:Pe,outerWidth:ze,outerHeight:Ee,margin:Be});return n.jsx(o.SvgWrapper,{width:ze,height:Ee,margin:Be,role:We,children:Q.map((function(o,t){return void 0!==Fe[o]?Fe[o]:"function"==typeof o?n.jsx(e.Fragment,{children:e.createElement(o,Ge)},t):null}))})},K=function(e){var t=e.theme,r=e.isInteractive,i=void 0===r?W.isInteractive:r,a=e.animate,u=void 0===a?W.animate:a,l=e.motionConfig,s=void 0===l?W.motionConfig:l,c=e.renderWrapper,d=w(e,_);return n.jsx(o.Container,{isInteractive:i,animate:u,motionConfig:s,theme:t,renderWrapper:c,children:n.jsx(J,b({isInteractive:i},d))})},Q=["nodes"],U=["theme","isInteractive","animate","motionConfig","renderWrapper"],Z=function(e,o){var t=o.node,r=o.getBorderWidth,i=o.getBorderColor,n=r(t);n>0&&(e.strokeStyle=i(t),e.lineWidth=n),e.beginPath(),e.arc(t.x,t.y,t.size/2,0,2*Math.PI),e.fillStyle=t.color,e.fill(),n>0&&e.stroke()},$=function(u){var l=u.data,s=u.width,c=u.height,d=u.margin,v=u.id,h=void 0===v?W.id:v,f=u.value,g=void 0===f?W.value:f,p=u.valueFormat,m=u.valueScale,x=void 0===m?W.valueScale:m,S=u.groups,M=u.groupBy,C=void 0===M?W.groupBy:M,b=u.size,k=void 0===b?W.size:b,I=u.forceStrength,j=void 0===I?W.forceStrength:I,z=u.simulationIterations,E=void 0===z?W.simulationIterations:z,B=u.colors,T=void 0===B?W.colors:B,P=u.colorBy,L=void 0===P?W.colorBy:P,V=u.borderColor,R=void 0===V?W.borderColor:V,q=u.layout,A=void 0===q?W.layout:q,F=u.spacing,G=void 0===F?W.spacing:F,H=u.gap,X=void 0===H?W.gap:H,Y=u.layers,D=void 0===Y?W.layers:Y,N=u.renderCircle,_=void 0===N?Z:N,J=u.debugMesh,K=void 0===J?W.debugMesh:J,U=u.enableGridX,$=u.gridXValues,ee=u.enableGridY,oe=u.gridYValues,te=u.axisTop,re=void 0===te?W.axisTop:te,ie=u.axisRight,ne=void 0===ie?W.axisRight:ie,ae=u.axisBottom,ue=void 0===ae?W.axisBottom:ae,le=u.axisLeft,se=void 0===le?W.axisLeft:le,ce=u.isInteractive,de=u.onMouseMove,ve=u.onClick,he=u.tooltip,fe=void 0===he?W.tooltip:he,ge=u.role,pe=void 0===ge?W.role:ge,me=u.pixelRatio,xe=void 0===me?W.pixelRatio:me,ye=e.useRef(null),Se=o.useTheme(),Me=e.useState(null),Ce=Me[0],be=Me[1],we=o.useDimensions(s,c,d),ke=we.outerWidth,Ie=we.outerHeight,We=we.margin,je=we.innerWidth,ze=we.innerHeight,Ee=O({width:je,height:ze,data:l,id:h,value:g,valueFormat:p,valueScale:x,groups:S,groupBy:C,size:k,spacing:G,layout:A,gap:X,colors:T,colorBy:L,forceStrength:j,simulationIterations:E}),Be=Ee.nodes,Te=w(Ee,Q),Pe=Te.xScale,Le=Te.yScale,Ve=r.useVoronoiMesh({points:Be,width:je,height:ze,debug:K}),Oe=Ve.delaunay,Re=Ve.voronoi,qe=a.useInheritedColor(R,Se),Ae=function(){return 1};e.useEffect((function(){if(ye.current){ye.current.width=ke*xe,ye.current.height=Ie*xe;var e=ye.current.getContext("2d");e&&(e.scale(xe,xe),e.fillStyle=Se.background,e.fillRect(0,0,ke,Ie),e.save(),e.translate(We.left,We.top),D.forEach((function(o){"grid"===o&&y.default(Se.grid.line.strokeWidth)&&Se.grid.line.strokeWidth>0&&(e.lineWidth=Se.grid.line.strokeWidth,e.strokeStyle=Se.grid.line.stroke,U&&t.renderGridLinesToCanvas(e,{width:je,height:ze,scale:Pe,axis:"x",values:$}),ee&&t.renderGridLinesToCanvas(e,{width:je,height:ze,scale:Le,axis:"y",values:oe})),"axes"===o&&t.renderAxesToCanvas(e,{xScale:Pe,yScale:Le,width:je,height:ze,top:re,right:ne,bottom:ue,left:se,theme:Se}),"circles"===o&&Be.forEach((function(o){_(e,{node:o,getBorderWidth:Ae,getBorderColor:qe})})),"mesh"===o&&K&&Re&&(r.renderVoronoiToCanvas(e,Re),Ce&&r.renderVoronoiCellToCanvas(e,Re,Ce.index))})))}}),[ye,ke,Ie,je,ze,xe,We,Se,D,Pe,Le,U,$,ee,oe,re,ne,ue,se,Re,K,Ce,Be,_,Ae,qe]);var Fe=e.useCallback((function(e){if(!ye.current)return null;var t=o.getRelativeCursor(ye.current,e),r=t[0],i=t[1];if(!o.isCursorInRect(We.left,We.top,je,ze,r,i))return null;var n=Oe.find(r-We.left,i-We.top);return Be[n]}),[ye,We,je,ze,Oe,Be]),Ge=i.useTooltip(),He=Ge.showTooltipFromEvent,Xe=Ge.hideTooltip,Ye=e.useCallback((function(o,t){He(e.createElement(fe,o),t)}),[He,fe]),De=e.useCallback((function(e){var o=Fe(e);be(o),o?(null==de||de(o,e),Ye(o,e)):Xe()}),[Fe,be,de,Ye,Xe]),Ne=e.useCallback((function(){Xe(),be(null)}),[Xe,be]),_e=e.useCallback((function(e){var o=Fe(e);o&&(null==ve||ve(o,e))}),[Fe,ve]);return n.jsx("canvas",{ref:ye,width:ke*xe,height:Ie*xe,style:{width:ke,height:Ie,cursor:ce?"auto":"normal"},role:pe,onMouseEnter:ce?De:void 0,onMouseMove:ce?De:void 0,onMouseLeave:ce?Ne:void 0,onClick:ce?_e:void 0})},ee=function(e){var t=e.theme,r=e.isInteractive,i=void 0===r?W.isInteractive:r,a=e.animate,u=void 0===a?W.animate:a,l=e.motionConfig,s=void 0===l?W.motionConfig:l,c=e.renderWrapper,d=w(e,U);return n.jsx(o.Container,{isInteractive:i,animate:u,motionConfig:s,theme:t,renderWrapper:c,children:n.jsx($,b({isInteractive:i},d))})};exports.InnerSwarmPlotCanvas=$,exports.ResponsiveSwarmPlot=function(e){return n.jsx(o.ResponsiveWrapper,{children:function(o){var t=o.width,r=o.height;return n.jsx(K,b({width:t,height:r},e))}})},exports.ResponsiveSwarmPlotCanvas=function(e){return n.jsx(o.ResponsiveWrapper,{children:function(o){var t=o.width,r=o.height;return n.jsx(ee,b({width:t,height:r},e))}})},exports.SwarmPlot=K,exports.SwarmPlotCanvas=ee,exports.SwarmPlotTooltip=I,exports.computeForces=B,exports.computeNodes=T,exports.computeOrdinalScale=j,exports.computeValueScale=z,exports.defaultProps=W,exports.getSizeGenerator=E,exports.renderCircleDefault=Z,exports.useBorderWidth=R,exports.useForces=V,exports.useNodeMouseHandlers=q,exports.useOrdinalScale=L,exports.useSwarmPlot=O,exports.useSwarmPlotAnnotations=G,exports.useSwarmPlotLayerContext=H,exports.useValueScale=P;
//# sourceMappingURL=nivo-swarmplot.cjs.js.map
