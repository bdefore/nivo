"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),n=require("@nivo/core"),o=require("@nivo/axes"),i=require("@nivo/legends"),t=require("@nivo/colors"),r=require("@nivo/scales"),a=require("@nivo/annotations"),s=require("lodash/get"),l=require("lodash/isString"),d=require("lodash/isNumber"),u=require("lodash/isPlainObject"),c=require("d3-scale"),v=require("@react-spring/web"),h=require("react/jsx-runtime"),f=require("@nivo/tooltip"),m=require("@nivo/voronoi");function g(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var x=g(s),p=g(l),y=g(d),M=g(u);function b(){return b=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var o=arguments[n];for(var i in o)Object.prototype.hasOwnProperty.call(o,i)&&(e[i]=o[i])}return e},b.apply(this,arguments)}function S(e,n){if(null==e)return{};var o,i,t={},r=Object.keys(e);for(i=0;i<r.length;i++)o=r[i],n.indexOf(o)>=0||(t[o]=e[o]);return t}var C=function(e){if("function"==typeof e)return e;if(y.default(e))return function(){return e};if(function(e){return M.default(e)}(e)){if(!p.default(e.key))throw new Error("symbolSize is invalid, key should be a string pointing to the property to use to determine node size");if(!Array.isArray(e.values)||2!==e.values.length)throw new Error("symbolSize is invalid, values spec should be an array containing two values, min and max");if(!Array.isArray(e.sizes)||2!==e.sizes.length)throw new Error("symbolSize is invalid, sizes spec should be an array containing two values, min and max");var n=c.scaleLinear().domain([e.values[0],e.values[1]]).range([e.sizes[0],e.sizes[1]]);return function(o){return n(x.default(o,e.key))}}throw new Error("nodeSize is invalid, it should be either a function, a number or an object")},w=function(o){var i,a=o.data,s=o.xScaleSpec,l=o.xFormat,d=o.yScaleSpec,u=o.yFormat,c=o.width,v=o.height,h=o.nodeId,f=o.nodeSize,m=o.colors,g=e.useMemo((function(){return r.computeXYScalesForSeries(a,s,d,c,v)}),[a,s,d,c,v]),x=g.series,p=g.xScale,y=g.yScale,M=n.useValueFormatter(l),S=n.useValueFormatter(u),w=n.usePropertyAccessor(h),k=e.useMemo((function(){return function(e){var n=e.series,o=e.formatX,i=e.formatY,t=e.getNodeId,r=[];return n.forEach((function(e){e.data.forEach((function(n,a){var s={index:r.length,serieIndex:a,serieId:e.id,x:n.position.x,xValue:n.data.x,formattedX:o(n.data.x),y:n.position.y,yValue:n.data.y,formattedY:i(n.data.y),data:n.data};r.push(b({},s,{id:t(s)}))}))})),r}({series:x,formatX:M,formatY:S,getNodeId:w})}),[x,M,S,w]),I=(i=f,e.useMemo((function(){return C(i)}),[i])),E=t.useOrdinalColorScale(m,"serieId");return{xScale:p,yScale:y,nodes:e.useMemo((function(){return k.map((function(e){return b({},e,{size:I(e),color:E({serieId:e.serieId})})}))}),[k,I,E]),legendData:e.useMemo((function(){return x.map((function(e){return{id:e.id,label:e.id,color:E({serieId:e.id})}}))}),[x,E])}},k=function(e,n){return a.useAnnotations({data:e,annotations:n,getPosition:function(e){return{x:e.x,y:e.y}},getDimensions:function(e){return{size:e.size,width:e.size,height:e.size}}})},I=function(e){return e/2},E={xScale:{type:"linear",min:0,max:"auto"},yScale:{type:"linear",min:0,max:"auto"},enableGridX:!0,enableGridY:!0,axisBottom:{},axisLeft:{},nodeId:function(e){return e.serieId+"."+e.index},nodeSize:9,nodeComponent:function(n){var o=n.node,i=n.style,t=n.blendMode,r=n.isInteractive,a=n.onMouseEnter,s=n.onMouseMove,l=n.onMouseLeave,d=n.onClick,u=e.useCallback((function(e){return null==a?void 0:a(o,e)}),[o,a]),c=e.useCallback((function(e){return null==s?void 0:s(o,e)}),[o,s]),f=e.useCallback((function(e){return null==l?void 0:l(o,e)}),[o,l]),m=e.useCallback((function(e){return null==d?void 0:d(o,e)}),[o,d]);return h.jsx(v.animated.circle,{cx:i.x,cy:i.y,r:i.size.to(I),fill:i.color,style:{mixBlendMode:t},onMouseEnter:r?u:void 0,onMouseMove:r?c:void 0,onMouseLeave:r?f:void 0,onClick:r?m:void 0})},colors:{scheme:"nivo"},isInteractive:!0,debugMesh:!1,tooltip:function(e){var n=e.node;return h.jsx(f.BasicTooltip,{id:n.serieId,value:"x: "+n.formattedX+", y: "+n.formattedY,enableChip:!0,color:n.color})},markers:[],legends:[],annotations:[]},j=b({},E,{blendMode:"normal",layers:["grid","axes","nodes","markers","mesh","legends","annotations"],role:"img",useMesh:!0,animate:!0,motionConfig:"default"}),z=b({},E,{layers:["grid","axes","nodes","mesh","legends","annotations"],pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1,renderNode:function(e,n){e.beginPath(),e.arc(n.x,n.y,n.size/2,0,2*Math.PI),e.fillStyle=n.color,e.fill()}}),L=function(e){var n=e.nodes,o=e.annotations,i=k(n,o);return h.jsx(h.Fragment,{children:i.map((function(e,n){return h.jsx(a.Annotation,b({},e),n)}))})},T=function(e){return e.id},W=function(e){return{x:e.x,y:e.y,size:e.size,color:e.color}},F=function(e){return{x:e.x,y:e.y,size:0,color:e.color}},P=function(o){var i=o.nodes,t=o.nodeComponent,r=o.isInteractive,a=o.onMouseEnter,s=o.onMouseMove,l=o.onMouseLeave,d=o.onClick,u=o.tooltip,c=o.blendMode,m=n.useMotionConfig(),g=m.animate,x=m.config,p=v.useTransition(i,{keys:T,from:W,enter:W,update:W,leave:F,config:x,immediate:!g}),y=f.useTooltip(),M=y.showTooltipFromEvent,b=y.hideTooltip,S=e.useCallback((function(n,o){M(e.createElement(u,{node:n}),o),null==a||a(n,o)}),[u,M,a]),C=e.useCallback((function(n,o){M(e.createElement(u,{node:n}),o),null==s||s(n,o)}),[u,M,s]),w=e.useCallback((function(e,n){b(),null==l||l(e,n)}),[b,l]),k=e.useCallback((function(e,n){return null==d?void 0:d(e,n)}),[d]);return h.jsx(h.Fragment,{children:p((function(n,o){return e.createElement(t,{node:o,style:n,blendMode:c,isInteractive:r,onMouseEnter:r?S:void 0,onMouseMove:r?C:void 0,onMouseLeave:r?w:void 0,onClick:r?k:void 0})}))})},q=function(n){var o=n.nodes,i=n.width,t=n.height,r=n.onMouseEnter,a=n.onMouseMove,s=n.onMouseLeave,l=n.onClick,d=n.tooltip,u=n.debug,c=f.useTooltip(),v=c.showTooltipFromEvent,g=c.hideTooltip,x=e.useCallback((function(n,o){v(e.createElement(d,{node:n}),o),r&&r(n,o)}),[v,d,r]),p=e.useCallback((function(n,o){v(e.createElement(d,{node:n}),o),a&&a(n,o)}),[v,d,a]),y=e.useCallback((function(e,n){g(),s&&s(e,n)}),[g,s]),M=e.useCallback((function(e,n){l&&l(e,n)}),[l]);return h.jsx(m.Mesh,{nodes:o,width:i,height:t,onMouseEnter:x,onMouseMove:p,onMouseLeave:y,onClick:M,debug:u})},R=["isInteractive","animate","motionConfig","theme","renderWrapper"],G=function(t){var r=t.data,a=t.xScale,s=void 0===a?j.xScale:a,l=t.xFormat,d=t.yScale,u=void 0===d?j.yScale:d,c=t.yFormat,v=t.width,f=t.height,m=t.margin,g=t.layers,x=void 0===g?j.layers:g,p=t.colors,y=void 0===p?j.colors:p,M=t.blendMode,S=void 0===M?j.blendMode:M,C=t.nodeId,k=void 0===C?j.nodeId:C,I=t.nodeSize,E=void 0===I?j.nodeSize:I,z=t.nodeComponent,T=void 0===z?j.nodeComponent:z,W=t.enableGridX,F=void 0===W?j.enableGridX:W,R=t.enableGridY,G=void 0===R?j.enableGridY:R,V=t.gridXValues,B=t.gridYValues,X=t.axisTop,Y=t.axisRight,A=t.axisBottom,D=void 0===A?j.axisBottom:A,H=t.axisLeft,O=void 0===H?j.axisLeft:H,N=t.annotations,_=void 0===N?j.annotations:N,U=t.isInteractive,J=void 0===U?j.isInteractive:U,K=t.useMesh,Q=void 0===K?j.useMesh:K,Z=t.debugMesh,$=void 0===Z?j.debugMesh:Z,ee=t.onMouseEnter,ne=t.onMouseMove,oe=t.onMouseLeave,ie=t.onClick,te=t.tooltip,re=void 0===te?j.tooltip:te,ae=t.markers,se=void 0===ae?j.markers:ae,le=t.legends,de=void 0===le?j.legends:le,ue=t.role,ce=void 0===ue?j.role:ue,ve=t.ariaLabel,he=t.ariaLabelledBy,fe=t.ariaDescribedBy,me=n.useDimensions(v,f,m),ge=me.margin,xe=me.innerWidth,pe=me.innerHeight,ye=me.outerWidth,Me=me.outerHeight,be=w({data:r,xScaleSpec:s,xFormat:l,yScaleSpec:u,yFormat:c,width:xe,height:pe,nodeId:k,nodeSize:E,colors:y}),Se=be.xScale,Ce=be.yScale,we=be.nodes,ke=be.legendData,Ie=e.useMemo((function(){return{xScale:Se,yScale:Ce,nodes:we,margin:ge,innerWidth:xe,innerHeight:pe,outerWidth:ye,outerHeight:Me}}),[Se,Ce,we,ge,xe,pe,ye,Me]),Ee={grid:null,axes:null,nodes:null,markers:null,mesh:null,annotations:null,legends:null};return x.includes("grid")&&(Ee.grid=h.jsx(o.Grid,{width:xe,height:pe,xScale:F?Se:null,yScale:G?Ce:null,xValues:V,yValues:B},"grid")),x.includes("axes")&&(Ee.axes=h.jsx(o.Axes,{xScale:Se,yScale:Ce,width:xe,height:pe,top:X,right:Y,bottom:D,left:O},"axes")),x.includes("nodes")&&(Ee.nodes=h.jsx(P,{nodes:we,nodeComponent:T,isInteractive:J,tooltip:re,blendMode:S,onMouseEnter:ee,onMouseMove:ne,onMouseLeave:oe,onClick:ie},"nodes")),x.includes("markers")&&(Ee.markers=h.jsx(n.CartesianMarkers,{markers:se,width:xe,height:pe,xScale:Se,yScale:Ce},"markers")),x.includes("mesh")&&J&&Q&&(Ee.mesh=h.jsx(q,{nodes:we,width:xe,height:pe,onMouseEnter:ee,onMouseMove:ne,onMouseLeave:oe,onClick:ie,tooltip:re,debug:$},"mesh")),x.includes("annotations")&&(Ee.annotations=h.jsx(L,{nodes:we,annotations:_},"annotations")),x.includes("legends")&&(Ee.legends=de.map((function(e,n){return h.jsx(i.BoxLegendSvg,b({},e,{containerWidth:xe,containerHeight:pe,data:ke}),n)}))),h.jsx(n.SvgWrapper,{width:ye,height:Me,margin:ge,role:ce,ariaLabel:ve,ariaLabelledBy:he,ariaDescribedBy:fe,children:x.map((function(n,o){if("string"==typeof n&&void 0!==Ee[n])return Ee[n];if("function"==typeof n)return h.jsx(e.Fragment,{children:e.createElement(n,Ie)},o);throw new Error("Unknown layer ("+n+")")}))})},V=function(e){var o=e.isInteractive,i=void 0===o?j.isInteractive:o,t=e.animate,r=void 0===t?j.animate:t,a=e.motionConfig,s=void 0===a?j.motionConfig:a,l=e.theme,d=e.renderWrapper,u=S(e,R);return h.jsx(n.Container,{animate:r,isInteractive:i,motionConfig:s,renderWrapper:d,theme:l,children:h.jsx(G,b({isInteractive:i},u))})},B=["isInteractive","renderWrapper","theme"],X=function(t){var r=t.data,s=t.xScale,l=void 0===s?z.xScale:s,d=t.xFormat,u=t.yScale,c=void 0===u?z.yScale:u,v=t.yFormat,g=t.width,x=t.height,p=t.margin,y=t.pixelRatio,M=void 0===y?z.pixelRatio:y,S=t.layers,C=void 0===S?z.layers:S,I=t.colors,E=void 0===I?z.colors:I,L=t.nodeId,T=void 0===L?j.nodeId:L,W=t.nodeSize,F=void 0===W?z.nodeSize:W,P=t.renderNode,q=void 0===P?z.renderNode:P,R=t.enableGridX,G=void 0===R?z.enableGridX:R,V=t.gridXValues,B=t.enableGridY,X=void 0===B?z.enableGridY:B,Y=t.gridYValues,A=t.axisTop,D=t.axisRight,H=t.axisBottom,O=void 0===H?z.axisBottom:H,N=t.axisLeft,_=void 0===N?z.axisLeft:N,U=t.annotations,J=void 0===U?z.annotations:U,K=t.isInteractive,Q=void 0===K?z.isInteractive:K,Z=t.debugMesh,$=void 0===Z?z.debugMesh:Z,ee=t.onMouseEnter,ne=t.onMouseMove,oe=t.onMouseLeave,ie=t.onClick,te=t.tooltip,re=void 0===te?z.tooltip:te,ae=t.legends,se=void 0===ae?z.legends:ae,le=e.useRef(null),de=n.useTheme(),ue=e.useState(null),ce=ue[0],ve=ue[1],he=n.useDimensions(g,x,p),fe=he.margin,me=he.innerWidth,ge=he.innerHeight,xe=he.outerWidth,pe=he.outerHeight,ye=w({data:r,xScaleSpec:l,xFormat:d,yScaleSpec:c,yFormat:v,width:me,height:ge,nodeId:T,nodeSize:F,colors:E}),Me=ye.xScale,be=ye.yScale,Se=ye.nodes,Ce=ye.legendData,we=k(Se,J),ke=m.useVoronoiMesh({points:Se,width:me,height:ge,debug:$}),Ie=ke.delaunay,Ee=ke.voronoi,je=e.useMemo((function(){return{xScale:Me,yScale:be,nodes:Se,margin:fe,innerWidth:me,innerHeight:ge,outerWidth:xe,outerHeight:pe}}),[Me,be,Se,fe,me,ge,xe,pe]);e.useEffect((function(){if(le.current){le.current.width=xe*M,le.current.height=pe*M;var e=le.current.getContext("2d");e.scale(M,M),e.fillStyle=de.background,e.fillRect(0,0,xe,pe),e.translate(fe.left,fe.top),C.forEach((function(n){if("grid"===n)e.lineWidth=de.grid.line.strokeWidth,e.strokeStyle=de.grid.line.stroke,G&&o.renderGridLinesToCanvas(e,{width:me,height:ge,scale:Me,axis:"x",values:V}),X&&o.renderGridLinesToCanvas(e,{width:me,height:ge,scale:be,axis:"y",values:Y});else if("annotations"===n)a.renderAnnotationsToCanvas(e,{annotations:we,theme:de});else if("axes"===n)o.renderAxesToCanvas(e,{xScale:Me,yScale:be,width:me,height:ge,top:A,right:D,bottom:O,left:_,theme:de});else if("nodes"===n)Se.forEach((function(n){q(e,n)}));else if("mesh"===n)$&&(m.renderVoronoiToCanvas(e,Ee),ce&&m.renderVoronoiCellToCanvas(e,Ee,ce.index));else if("legends"===n)se.forEach((function(n){i.renderLegendToCanvas(e,b({},n,{data:Ce,containerWidth:me,containerHeight:ge,theme:de}))}));else{if("function"!=typeof n)throw new Error("Invalid layer: "+n);n(e,je)}}))}}),[le,me,ge,xe,pe,fe.top,fe.left,M,q,C,je,de,Me,be,Se,G,X,A,D,O,_,se,Ce,$,Ee,ce,we]);var ze=f.useTooltip(),Le=ze.showTooltipFromEvent,Te=ze.hideTooltip,We=e.useCallback((function(e){var o=n.getRelativeCursor(le.current,e),i=o[0],t=o[1];if(!n.isCursorInRect(fe.left,fe.top,me,ge,i,t))return null;var r=Ie.find(i-fe.left,t-fe.top);return Se[r]}),[le,fe,me,ge,Ie]),Fe=e.useCallback((function(n){var o=We(n);ve(o),o?(Le(e.createElement(re,{node:o}),n),ce&&ce.id!==o.id&&(oe&&oe(ce,n),ee&&ee(o,n)),ce||ee&&ee(o,n),ne&&ne(o,n)):(Te(),ce&&oe&&oe(ce,n))}),[We,ce,ve,Le,Te,re,ee,ne,oe]),Pe=e.useCallback((function(e){Te(),ve(null),ce&&oe&&oe(ce,e)}),[Te,ce,ve,oe]),qe=e.useCallback((function(e){if(ie){var n=We(e);n&&ie(n,e)}}),[We,ie]);return h.jsx("canvas",{ref:le,width:xe*M,height:pe*M,style:{width:xe,height:pe,cursor:Q?"auto":"normal"},onMouseEnter:Q?Fe:void 0,onMouseMove:Q?Fe:void 0,onMouseLeave:Q?Pe:void 0,onClick:Q?qe:void 0})},Y=function(e){var o=e.isInteractive,i=e.renderWrapper,t=e.theme,r=S(e,B);return h.jsx(n.Container,{isInteractive:o,renderWrapper:i,theme:t,animate:!1,children:h.jsx(X,b({},r))})};exports.ResponsiveScatterPlot=function(e){return h.jsx(n.ResponsiveWrapper,{children:function(n){var o=n.width,i=n.height;return h.jsx(V,b({width:o,height:i},e))}})},exports.ResponsiveScatterPlotCanvas=function(e){return h.jsx(n.ResponsiveWrapper,{children:function(n){var o=n.width,i=n.height;return h.jsx(Y,b({width:o,height:i},e))}})},exports.ScatterPlot=V,exports.ScatterPlotCanvas=Y,exports.canvasDefaultProps=z,exports.commonDefaultProps=E,exports.svgDefaultProps=j,exports.useScatterPlot=w,exports.useScatterPlotAnnotations=k;
//# sourceMappingURL=nivo-scatterplot.cjs.js.map
