import{memo as e,useState as n,useMemo as i,useEffect as o,useCallback as t,createElement as r,Fragment as d,useRef as a}from"react";import{useTheme as c,useMotionConfig as l,Container as s,useDimensions as u,SvgWrapper as v,ResponsiveWrapper as f,getRelativeCursor as h,getDistance as k}from"@nivo/core";import{animated as p,to as m,useTransition as g}from"@react-spring/web";import{jsx as y,Fragment as C}from"react/jsx-runtime";import{BasicTooltip as M,useTooltip as x}from"@nivo/tooltip";import{forceLink as z,forceManyBody as I,forceCenter as S,forceSimulation as b}from"d3-force";import{useInheritedColor as N}from"@nivo/colors";import{useAnnotations as W,Annotation as B,useComputedAnnotations as T,renderAnnotationsToCanvas as w}from"@nivo/annotations";function A(){return A=Object.assign||function(e){for(var n=1;n<arguments.length;n++){var i=arguments[n];for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(e[o]=i[o])}return e},A.apply(this,arguments)}function L(e,n){if(null==e)return{};var i,o,t={},r=Object.keys(e);for(o=0;o<r.length;o++)i=r[o],n.indexOf(i)>=0||(t[i]=e[i]);return t}var D=e((function(e){var n=e.node,i=e.animated,o=e.onClick,t=e.onMouseEnter,r=e.onMouseMove,d=e.onMouseLeave;return y(p.circle,{"data-testid":"node."+n.id,transform:m([i.x,i.y,i.scale],(function(e,n,i){return"translate("+e+","+n+") scale("+i+")"})),r:m([i.size],(function(e){return e/2})),fill:i.color,strokeWidth:i.borderWidth,stroke:i.borderColor,opacity:i.opacity,onClick:o?function(e){return o(n,e)}:void 0,onMouseEnter:t?function(e){return t(n,e)}:void 0,onMouseMove:r?function(e){return r(n,e)}:void 0,onMouseLeave:d?function(e){return d(n,e)}:void 0})})),E=e((function(e){var n=e.link,i=e.animated,o=e.blendMode;return y(p.line,{"data-testid":"link."+n.id,stroke:i.color,style:{mixBlendMode:o},strokeWidth:n.thickness,strokeLinecap:"round",opacity:i.opacity,x1:i.x1,y1:i.y1,x2:i.x2,y2:i.y2})})),P={layers:["links","nodes","annotations"],linkDistance:30,centeringStrength:1,repulsivity:10,distanceMin:1,distanceMax:1/0,iterations:120,nodeSize:12,activeNodeSize:18,inactiveNodeSize:8,nodeColor:"#000000",nodeBorderWidth:0,nodeBorderColor:{from:"color"},linkThickness:1,linkColor:{from:"source.color"},isInteractive:!0,defaultActiveNodeIds:[],nodeTooltip:function(e){var n=e.node;return y(M,{id:n.id,enableChip:!0,color:n.color})},annotations:[],animate:!0,motionConfig:"gentle",role:"img"},O=A({},P,{nodeComponent:D,linkComponent:E,linkBlendMode:"normal"}),R=A({},P,{renderNode:function(e,n){e.fillStyle=n.color,e.beginPath(),e.arc(n.x,n.y,n.size/2,0,2*Math.PI),e.fill(),n.borderWidth>0&&(e.strokeStyle=n.borderColor,e.lineWidth=n.borderWidth,e.stroke())},renderLink:function(e,n){e.strokeStyle=n.color,e.lineWidth=n.thickness,e.beginPath(),e.moveTo(n.source.x,n.source.y),e.lineTo(n.target.x,n.target.y),e.stroke()},pixelRatio:"undefined"!=typeof window&&window.devicePixelRatio||1}),j=["index"],H=function(e){return i((function(){return"function"==typeof e?e:function(){return e}}),[e])},F=function(e){var r=e.center,d=e.nodes,a=e.links,l=e.linkDistance,s=void 0===l?P.linkDistance:l,u=e.centeringStrength,v=void 0===u?P.centeringStrength:u,f=e.repulsivity,h=void 0===f?P.repulsivity:f,k=e.distanceMin,p=void 0===k?P.distanceMin:k,m=e.distanceMax,g=void 0===m?P.distanceMax:m,y=e.iterations,C=void 0===y?P.iterations:y,M=e.nodeSize,x=void 0===M?P.nodeSize:M,W=e.activeNodeSize,B=void 0===W?P.activeNodeSize:W,T=e.inactiveNodeSize,w=void 0===T?P.inactiveNodeSize:T,D=e.nodeColor,E=void 0===D?P.nodeColor:D,O=e.nodeBorderWidth,R=void 0===O?P.nodeBorderWidth:O,F=e.nodeBorderColor,q=void 0===F?P.nodeBorderColor:F,G=e.linkThickness,J=void 0===G?P.linkThickness:G,K=e.linkColor,Q=void 0===K?P.linkColor:K,U=e.isInteractive,V=void 0===U?P.isInteractive:U,X=e.defaultActiveNodeIds,Y=void 0===X?P.defaultActiveNodeIds:X,Z=n(null),$=Z[0],_=Z[1],ee=n(null),ne=ee[0],ie=ee[1],oe=function(e){var n=e.linkDistance,o=e.centeringStrength,t=e.repulsivity,r=e.distanceMin,d=e.distanceMax,a=e.center,c=H(n),l=a[0],s=a[1];return i((function(){return{link:z().distance((function(e){return c(e.data)})).strength(o),charge:I().strength(-t).distanceMin(r).distanceMax(d),center:S(l,s)}}),[c,o,t,r,d,l,s])}({linkDistance:s,centeringStrength:v,repulsivity:h,distanceMin:p,distanceMax:g,center:r});o((function(){var e=d.map((function(e){return{id:e.id,data:A({},e),index:0,x:0,y:0,vx:0,vy:0}})),n=a.map((function(n){return{data:A({},n),index:0,source:e.find((function(e){return e.id===n.source})),target:e.find((function(e){return e.id===n.target}))}})),i=b(e).force("link",oe.link.links(n)).force("charge",oe.charge).force("center",oe.center).stop();return i.tick(C),_(e),ie(n),function(){i.stop()}}),[d,a,oe,C,_,ie]);var te=n(Y),re=te[0],de=te[1],ae=function(e){var n=e.size,i=e.activeSize,o=e.inactiveSize,r=e.color,d=e.borderWidth,a=e.borderColor,l=e.isInteractive,s=e.activeNodeIds,u=c(),v=H(n),f=H(r),h=H(d),k=N(a,u),p=t((function(e){var n=f(e.data);return{size:v(e.data),color:n,borderWidth:h(e.data),borderColor:k(A({},e,{color:n}))}}),[v,f,h,k]),m=H(i),g=t((function(e){var n=f(e.data);return{size:m(e.data),color:n,borderWidth:h(e.data),borderColor:k(A({},e,{color:n}))}}),[m,f,h,k]),y=H(o),C=t((function(e){var n=f(e.data);return{size:y(e.data),color:n,borderWidth:h(e.data),borderColor:k(A({},e,{color:n}))}}),[y,f,h,k]);return t((function(e){return l&&0!==s.length?s.includes(e.id)?g(e):C(e):p(e)}),[p,g,C,l,s])}({size:x,activeSize:B,inactiveSize:w,color:E,borderWidth:R,borderColor:q,isInteractive:V,activeNodeIds:re}),ce=i((function(){return null===$?null:$.map((function(e){return A({},e,ae(e))}))}),[$,ae]),le=c(),se=H(J),ue=N(Q,le),ve=i((function(){return null===ne||null===ce?null:ne.map((function(e){var n=e.index,i=L(e,j),o={id:i.source.id+"."+i.target.id,data:i.data,index:n,source:ce.find((function(e){return e.id===i.source.id})),target:ce.find((function(e){return e.id===i.target.id}))};return A({},o,{thickness:se(o),color:ue(o)})}))}),[ne,ce,se,ue]);return{nodes:ce,links:ve,activeNodeIds:re,setActiveNodeIds:de}},q=function(e){return{x:e.x,y:e.y}},G=function(e){return{size:e.size,width:e.size,height:e.size}},J=function(e,n){return W({data:e,annotations:n,getPosition:q,getDimensions:G})},K=function(e){var n=e.links,o=e.linkComponent,t=e.blendMode,d=l(),a=d.animate,c=d.config,s=i((function(){return[function(e){return{x1:e.source.x,y1:e.source.y,x2:e.source.x,y2:e.source.y,color:e.color,opacity:0}},function(e){return{x1:e.source.x,y1:e.source.y,x2:e.target.x,y2:e.target.y,color:e.color,opacity:1}}]}),[]),u=s[0],v=s[1],f=g(n,{keys:function(e){return e.id},initial:v,from:u,enter:v,update:v,expires:!0,config:c,immediate:!a});return y(C,{children:f((function(e,n){return r(o,{key:n.id,link:n,animated:e,blendMode:t})}))})},Q=function(e){var n=e.nodes,o=e.nodeComponent,d=e.onMouseEnter,a=e.onMouseMove,c=e.onMouseLeave,s=e.onClick,u=e.tooltip,v=e.setActiveNodeIds,f=e.isInteractive,h=l(),k=h.animate,p=h.config,m=i((function(){return[function(e){return{x:e.x,y:e.y,size:e.size,color:e.color,borderWidth:e.borderWidth,borderColor:e.borderColor,scale:0,opacity:0}},function(e){return{x:e.x,y:e.y,size:e.size,color:e.color,borderWidth:e.borderWidth,borderColor:e.borderColor,scale:1,opacity:1}},function(e){return{x:e.x,y:e.y,size:e.size,color:e.color,borderWidth:e.borderWidth,borderColor:e.borderColor,scale:0,opacity:0}}]}),[]),M=m[0],z=m[1],I=m[2],S=g(n,{keys:function(e){return e.id},initial:z,from:M,enter:z,update:z,leave:I,config:p,immediate:!k}),b=x(),N=b.showTooltipFromEvent,W=b.hideTooltip,B=t((function(e,n){N(r(u,{node:e}),n),v([e.id]),null==d||d(e,n)}),[N,u,v,d]),T=t((function(e,n){N(r(u,{node:e}),n),null==a||a(e,n)}),[N,u,a]),w=t((function(e,n){W(),v([]),null==c||c(e,n)}),[W,v,c]);return y(C,{children:S((function(e,n){return r(o,{key:n.id,node:n,animated:e,onMouseEnter:f?B:void 0,onMouseMove:f?T:void 0,onMouseLeave:f?w:void 0,onClick:f?s:void 0})}))})},U=function(e){var n=e.nodes,i=e.annotations,o=J(n,i);return y(C,{children:o.map((function(e,n){return y(B,A({},e),n)}))})},V=["isInteractive","animate","motionConfig","theme","renderWrapper"],X=function(e){var n=e.width,o=e.height,t=e.margin,a=e.data,c=a.nodes,l=a.links,s=e.linkDistance,f=void 0===s?O.linkDistance:s,h=e.centeringStrength,k=void 0===h?O.centeringStrength:h,p=e.repulsivity,m=void 0===p?O.repulsivity:p,g=e.distanceMin,C=void 0===g?O.distanceMin:g,M=e.distanceMax,x=void 0===M?O.distanceMax:M,z=e.iterations,I=void 0===z?O.iterations:z,S=e.layers,b=void 0===S?O.layers:S,N=e.nodeComponent,W=void 0===N?O.nodeComponent:N,B=e.nodeSize,T=void 0===B?O.nodeSize:B,w=e.activeNodeSize,A=void 0===w?O.activeNodeSize:w,L=e.inactiveNodeSize,D=void 0===L?O.inactiveNodeSize:L,E=e.nodeColor,P=void 0===E?O.nodeColor:E,R=e.nodeBorderWidth,j=void 0===R?O.nodeBorderWidth:R,H=e.nodeBorderColor,q=void 0===H?O.nodeBorderColor:H,G=e.linkComponent,J=void 0===G?O.linkComponent:G,V=e.linkThickness,X=void 0===V?O.linkThickness:V,Y=e.linkColor,Z=void 0===Y?O.linkColor:Y,$=e.linkBlendMode,_=void 0===$?O.linkBlendMode:$,ee=e.annotations,ne=void 0===ee?O.annotations:ee,ie=e.isInteractive,oe=void 0===ie?O.isInteractive:ie,te=e.defaultActiveNodeIds,re=void 0===te?O.defaultActiveNodeIds:te,de=e.nodeTooltip,ae=void 0===de?O.nodeTooltip:de,ce=e.onMouseEnter,le=e.onMouseMove,se=e.onMouseLeave,ue=e.onClick,ve=e.role,fe=void 0===ve?O.role:ve,he=e.ariaLabel,ke=e.ariaLabelledBy,pe=e.ariaDescribedBy,me=u(n,o,t),ge=me.margin,ye=me.innerWidth,Ce=me.innerHeight,Me=me.outerWidth,xe=me.outerHeight,ze=F({center:[ye/2,Ce/2],nodes:c,links:l,linkDistance:f,centeringStrength:k,repulsivity:m,distanceMin:C,distanceMax:x,iterations:I,nodeSize:T,activeNodeSize:A,inactiveNodeSize:D,nodeColor:P,nodeBorderWidth:j,nodeBorderColor:q,linkThickness:X,linkColor:Z,isInteractive:oe,defaultActiveNodeIds:re}),Ie=ze.nodes,Se=ze.links,be=ze.activeNodeIds,Ne=ze.setActiveNodeIds,We={links:null,nodes:null,annotations:null};b.includes("links")&&null!==Se&&(We.links=y(K,{links:Se,linkComponent:J,blendMode:_},"links")),b.includes("nodes")&&null!==Ie&&(We.nodes=y(Q,{nodes:Ie,nodeComponent:W,onMouseEnter:ce,onMouseMove:le,onMouseLeave:se,onClick:ue,tooltip:ae,setActiveNodeIds:Ne,isInteractive:oe},"nodes")),b.includes("annotations")&&null!==Ie&&(We.annotations=y(U,{nodes:Ie,annotations:ne},"annotations"));var Be=i((function(){return{nodes:Ie||[],links:Se||[],activeNodeIds:be,setActiveNodeIds:Ne}}),[Ie,Se,be,Ne]);return y(v,{width:Me,height:xe,margin:ge,role:fe,ariaLabel:he,ariaLabelledBy:ke,ariaDescribedBy:pe,children:b.map((function(e,n){var i;return"function"==typeof e?y(d,{children:r(e,Be)},n):null!=(i=null==We?void 0:We[e])?i:null}))})},Y=function(e){var n=e.isInteractive,i=void 0===n?O.isInteractive:n,o=e.animate,t=void 0===o?O.animate:o,r=e.motionConfig,d=void 0===r?O.motionConfig:r,a=e.theme,c=e.renderWrapper,l=L(e,V);return y(s,{animate:t,isInteractive:i,motionConfig:d,renderWrapper:c,theme:a,children:y(X,A({isInteractive:i},l))})},Z=function(e){return y(f,{children:function(n){var i=n.width,o=n.height;return y(Y,A({width:i,height:o},e))}})},$=["theme","isInteractive","animate","motionConfig","renderWrapper"],_=function(e){var n=e.width,d=e.height,l=e.margin,s=e.pixelRatio,v=void 0===s?R.pixelRatio:s,f=e.data,p=f.nodes,m=f.links,g=e.linkDistance,C=void 0===g?R.linkDistance:g,M=e.centeringStrength,z=void 0===M?R.centeringStrength:M,I=e.repulsivity,S=void 0===I?R.repulsivity:I,b=e.distanceMin,N=void 0===b?R.distanceMin:b,W=e.distanceMax,B=void 0===W?R.distanceMax:W,A=e.iterations,L=void 0===A?R.iterations:A,D=e.layers,E=void 0===D?R.layers:D,P=e.renderNode,O=void 0===P?R.renderNode:P,j=e.nodeSize,H=void 0===j?R.nodeSize:j,q=e.activeNodeSize,G=void 0===q?R.activeNodeSize:q,K=e.inactiveNodeSize,Q=void 0===K?R.inactiveNodeSize:K,U=e.nodeColor,V=void 0===U?R.nodeColor:U,X=e.nodeBorderWidth,Y=void 0===X?R.nodeBorderWidth:X,Z=e.nodeBorderColor,$=void 0===Z?R.nodeBorderColor:Z,_=e.renderLink,ee=void 0===_?R.renderLink:_,ne=e.linkThickness,ie=void 0===ne?R.linkThickness:ne,oe=e.linkColor,te=void 0===oe?R.linkColor:oe,re=e.annotations,de=void 0===re?R.annotations:re,ae=e.isInteractive,ce=void 0===ae?R.isInteractive:ae,le=e.defaultActiveNodeIds,se=void 0===le?R.defaultActiveNodeIds:le,ue=e.nodeTooltip,ve=void 0===ue?R.nodeTooltip:ue,fe=e.onClick,he=a(null),ke=u(n,d,l),pe=ke.margin,me=ke.innerWidth,ge=ke.innerHeight,ye=ke.outerWidth,Ce=ke.outerHeight,Me=F({center:[me/2,ge/2],nodes:p,links:m,linkDistance:C,centeringStrength:z,repulsivity:S,distanceMin:N,distanceMax:B,iterations:L,nodeSize:H,activeNodeSize:G,inactiveNodeSize:Q,nodeColor:V,nodeBorderWidth:Y,nodeBorderColor:$,linkThickness:ie,linkColor:te,isInteractive:ce,defaultActiveNodeIds:se}),xe=Me.nodes,ze=Me.links,Ie=Me.activeNodeIds,Se=Me.setActiveNodeIds,be=J(xe,de),Ne=T({annotations:be}),We=i((function(){return{nodes:xe||[],links:ze||[],activeNodeIds:Ie,setActiveNodeIds:Se}}),[xe,ze,Ie,Se]),Be=c();o((function(){if(null!==he.current){he.current.width=ye*v,he.current.height=Ce*v;var e=he.current.getContext("2d");e.scale(v,v),e.fillStyle=Be.background,e.fillRect(0,0,ye,Ce),e.translate(pe.left,pe.top),E.forEach((function(n){"links"===n&&null!==ze?ze.forEach((function(n){return ee(e,n)})):"nodes"===n&&null!==xe?xe.forEach((function(n){return O(e,n)})):"annotations"===n?w(e,{annotations:Ne,theme:Be}):"function"==typeof n&&null!==xe&&null!==ze&&n(e,We)}))}}),[he,ye,Ce,pe.left,pe.top,v,E,Be,xe,ze,O,ee,Ne,We]);var Te=t((function(e){if(he.current&&null!==xe){var n=h(he.current,e),i=n[0],o=n[1];return xe.find((function(e){return k(e.x,e.y,i-pe.left,o-pe.top)<=e.size/2}))}}),[he,pe,xe]),we=x(),Ae=we.showTooltipFromEvent,Le=we.hideTooltip,De=t((function(e){var n=Te(e);n?(Ae(r(ve,{node:n}),e),Se([n.id])):(Le(),Se([]))}),[Te,Ae,ve,Le,Se]),Ee=t((function(){Le(),Se([])}),[Le,Se]),Pe=t((function(e){if(fe){var n=Te(e);n&&fe(n,e)}}),[Te,fe]);return y("canvas",{ref:he,width:ye*v,height:Ce*v,style:{width:ye,height:Ce,cursor:ce?"auto":"normal"},onClick:ce?Pe:void 0,onMouseEnter:ce?De:void 0,onMouseLeave:ce?Ee:void 0,onMouseMove:ce?De:void 0})},ee=function(e){var n=e.theme,i=e.isInteractive,o=void 0===i?R.isInteractive:i,t=e.animate,r=void 0===t?R.animate:t,d=e.motionConfig,a=void 0===d?R.motionConfig:d,c=e.renderWrapper,l=L(e,$);return y(s,{isInteractive:o,animate:r,motionConfig:a,theme:n,renderWrapper:c,children:y(_,A({isInteractive:o},l))})},ne=function(e){return y(f,{children:function(n){var i=n.width,o=n.height;return y(ee,A({width:i,height:o},e))}})};export{Y as Network,ee as NetworkCanvas,Z as ResponsiveNetwork,ne as ResponsiveNetworkCanvas,R as canvasDefaultProps,P as commonDefaultProps,O as svgDefaultProps,F as useNetwork,J as useNodeAnnotations};
//# sourceMappingURL=nivo-network.es.js.map
