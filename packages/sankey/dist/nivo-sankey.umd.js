!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o(exports,require("lodash/uniq"),require("react"),require("@nivo/core"),require("@nivo/legends"),require("d3-sankey"),require("@nivo/tooltip"),require("react/jsx-runtime"),require("lodash/cloneDeep"),require("@nivo/colors"),require("@react-spring/web"),require("d3-shape")):"function"==typeof define&&define.amd?define(["exports","lodash/uniq","react","@nivo/core","@nivo/legends","d3-sankey","@nivo/tooltip","react/jsx-runtime","lodash/cloneDeep","@nivo/colors","@react-spring/web","d3-shape"],o):o((e="undefined"!=typeof globalThis?globalThis:e||self).nivo=e.nivo||{},e["lodash/uniq"],e.React,e.nivo,e.nivo,e.d3,e.nivo,e["react/jsx-runtime"],e["lodash/cloneDeep"],e.nivo,e["@react-spring/web"],e.d3)}(this,(function(e,o,n,t,i,r,a,l,d,s,c,u){"use strict";function h(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var p=h(o),v=h(d);function g(){return g=Object.assign||function(e){for(var o=1;o<arguments.length;o++){var n=arguments[o];for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=n[t])}return e},g.apply(this,arguments)}var y={container:{display:"flex",alignItems:"center"},sourceChip:{marginRight:7},targetChip:{marginLeft:7,marginRight:7}},f={center:r.sankeyCenter,justify:r.sankeyJustify,start:r.sankeyLeft,end:r.sankeyRight},k=Object.keys(f),m=function(e){return f[e]},x={layout:"horizontal",align:"center",sort:"auto",colors:{scheme:"nivo"},nodeOpacity:.75,nodeHoverOpacity:1,nodeHoverOthersOpacity:.15,nodeThickness:12,nodeSpacing:12,nodeInnerPadding:0,nodeBorderWidth:1,nodeBorderColor:{from:"color",modifiers:[["darker",.5]]},nodeBorderRadius:0,linkOpacity:.25,linkHoverOpacity:.6,linkHoverOthersOpacity:.15,linkContract:0,linkBlendMode:"multiply",enableLinkGradient:!1,enableLabels:!0,label:"id",labelPosition:"inside",labelPadding:9,labelOrientation:"horizontal",labelTextColor:{from:"color",modifiers:[["darker",.8]]},isInteractive:!0,nodeTooltip:function(e){var o=e.node;return l.jsx(a.BasicTooltip,{id:o.label,enableChip:!0,color:o.color})},linkTooltip:function(e){var o=e.link;return l.jsx(a.BasicTooltip,{id:l.jsxs("span",{style:y.container,children:[l.jsx(a.Chip,{color:o.source.color,style:y.sourceChip}),l.jsx("strong",{children:o.source.label})," > ",l.jsx("strong",{children:o.target.label}),l.jsx(a.Chip,{color:o.target.color,style:y.targetChip}),l.jsx("strong",{children:o.formattedValue})]})})},legends:[],layers:["links","nodes","labels","legends"],role:"img",animate:!0,motionConfig:"gentle"},b=function(e){return e.id},C=function(e){var o=e.data,i=e.valueFormat,a=e.layout,l=e.width,d=e.height,c=e.sort,u=e.align,h=e.colors,p=e.nodeThickness,g=e.nodeSpacing,y=e.nodeInnerPadding,f=e.nodeBorderColor,k=e.label,x=e.labelTextColor,C=n.useState(null),O=C[0],j=C[1],M=n.useState(null),L=M[0],T=M[1],B=n.useMemo((function(){if("auto"!==c)return"input"===c?null:"ascending"===c?function(e,o){return e.value-o.value}:"descending"===c?function(e,o){return o.value-e.value}:c}),[c]),w="input"===c?null:void 0,I=n.useMemo((function(){return"function"==typeof u?u:m(u)}),[u]),P=t.useTheme(),H=s.useOrdinalColorScale(h,"id"),S=s.useInheritedColor(f,P),W=t.usePropertyAccessor(k),F=s.useInheritedColor(x,P),q=t.useValueFormatter(i),N=n.useMemo((function(){return function(e){var o=e.data,n=e.formatValue,t=e.layout,i=e.alignFunction,a=e.sortFunction,l=e.linkSortMode,d=e.nodeThickness,s=e.nodeSpacing,c=e.nodeInnerPadding,u=e.width,h=e.height,p=e.getColor,g=e.getLabel,y=r.sankey().nodeAlign(i).nodeSort(a).linkSort(l).nodeWidth(d).nodePadding(s).size("horizontal"===t?[u,h]:[h,u]).nodeId(b),f=v.default(o);return y(f),f.nodes.forEach((function(e){if(e.color=p(e),e.label=g(e),e.formattedValue=n(e.value),"horizontal"===t)e.x=e.x0+c,e.y=e.y0,e.width=Math.max(e.x1-e.x0-2*c,0),e.height=Math.max(e.y1-e.y0,0);else{e.x=e.y0,e.y=e.x0+c,e.width=Math.max(e.y1-e.y0,0),e.height=Math.max(e.x1-e.x0-2*c,0);var o=e.x0,i=e.x1;e.x0=e.y0,e.x1=e.y1,e.y0=o,e.y1=i}})),f.links.forEach((function(e){e.formattedValue=n(e.value),e.color=e.source.color,e.pos0=e.y0,e.pos1=e.y1,e.thickness=e.width,delete e.y0,delete e.y1,delete e.width})),f}({data:o,formatValue:q,layout:a,alignFunction:I,sortFunction:B,linkSortMode:w,nodeThickness:p,nodeSpacing:g,nodeInnerPadding:y,width:l,height:d,getColor:H,getLabel:W})}),[o,q,a,I,B,w,p,g,y,l,d,H,W]),R=N.nodes,E=N.links,A=n.useMemo((function(){return R.map((function(e){return{id:e.id,label:e.label,color:e.color}}))}),[R]);return{nodes:R,links:E,legendData:A,getNodeBorderColor:S,currentNode:O,setCurrentNode:j,currentLink:L,setCurrentLink:T,getLabelTextColor:F}},O=function(e){var o=e.node,i=e.x,r=e.y,d=e.width,s=e.height,u=e.color,h=e.opacity,p=e.borderWidth,v=e.borderColor,g=e.borderRadius,y=e.setCurrent,f=e.isInteractive,k=e.onClick,m=e.tooltip,x=t.useMotionConfig(),b=x.animate,C=x.config,O=c.useSpring({x:i,y:r,width:d,height:s,opacity:h,color:u,config:C,immediate:!b}),j=a.useTooltip(),M=j.showTooltipFromEvent,L=j.hideTooltip,T=n.useCallback((function(e){y(o),M(n.createElement(m,{node:o}),e,"left")}),[y,o,M,m]),B=n.useCallback((function(e){M(n.createElement(m,{node:o}),e,"left")}),[M,o,m]),w=n.useCallback((function(){y(null),L()}),[y,L]),I=n.useCallback((function(e){null==k||k(o,e)}),[k,o]);return l.jsx(c.animated.rect,{x:O.x,y:O.y,rx:g,ry:g,width:O.width.to((function(e){return Math.max(e,0)})),height:O.height.to((function(e){return Math.max(e,0)})),fill:O.color,fillOpacity:O.opacity,strokeWidth:p,stroke:v,strokeOpacity:h,onMouseEnter:f?T:void 0,onMouseMove:f?B:void 0,onMouseLeave:f?w:void 0,onClick:f?I:void 0})},j=function(e){var o=e.nodes,n=e.nodeOpacity,t=e.nodeHoverOpacity,i=e.nodeHoverOthersOpacity,r=e.borderWidth,a=e.getBorderColor,d=e.borderRadius,s=e.setCurrentNode,c=e.currentNode,u=e.currentLink,h=e.isCurrentNode,p=e.isInteractive,v=e.onClick,g=e.tooltip,y=function(e){return c||u?h(e)?t:i:n};return l.jsx(l.Fragment,{children:o.map((function(e){return l.jsx(O,{node:e,x:e.x,y:e.y,width:e.width,height:e.height,color:e.color,opacity:y(e),borderWidth:r,borderColor:a(e),borderRadius:d,setCurrent:s,isInteractive:p,onClick:v,tooltip:g},e.id)}))})},M=function(e){var o,n=e.id,t=e.layout,i=e.startColor,r=e.endColor;return o="horizontal"===t?{x1:"0%",x2:"100%",y1:"0%",y2:"0%"}:{x1:"0%",x2:"0%",y1:"0%",y2:"100%"},l.jsxs("linearGradient",g({id:n,spreadMethod:"pad"},o,{children:[l.jsx("stop",{offset:"0%",stopColor:i}),l.jsx("stop",{offset:"100%",stopColor:r})]}))},L=function(e){var o=e.link,i=e.layout,r=e.path,d=e.color,s=e.opacity,u=e.blendMode,h=e.enableGradient,p=e.setCurrent,v=e.tooltip,g=e.isInteractive,y=e.onClick,f=o.source.id+"."+o.target.id,k=t.useMotionConfig(),m=k.animate,x=k.config,b=t.useAnimatedPath(r),C=c.useSpring({color:d,opacity:s,config:x,immediate:!m}),O=a.useTooltip(),j=O.showTooltipFromEvent,L=O.hideTooltip,T=n.useCallback((function(e){p(o),j(n.createElement(v,{link:o}),e,"left")}),[p,o,j,v]),B=n.useCallback((function(e){j(n.createElement(v,{link:o}),e,"left")}),[j,o,v]),w=n.useCallback((function(){p(null),L()}),[p,L]),I=n.useCallback((function(e){null==y||y(o,e)}),[y,o]);return l.jsxs(l.Fragment,{children:[h&&l.jsx(M,{id:f,layout:i,startColor:o.startColor||o.source.color,endColor:o.endColor||o.target.color}),l.jsx(c.animated.path,{fill:h?'url("#'+encodeURI(f)+'")':C.color,d:b,fillOpacity:C.opacity,onMouseEnter:g?T:void 0,onMouseMove:g?B:void 0,onMouseLeave:g?w:void 0,onClick:g?I:void 0,style:{mixBlendMode:u}})]})},T=function(e){var o=e.links,t=e.layout,i=e.linkOpacity,r=e.linkHoverOpacity,a=e.linkHoverOthersOpacity,d=e.linkContract,s=e.linkBlendMode,c=e.enableLinkGradient,h=e.setCurrentLink,p=e.currentLink,v=e.currentNode,g=e.isCurrentLink,y=e.isInteractive,f=e.onClick,k=e.tooltip,m=function(e){return v||p?g(e)?r:a:i},x=n.useMemo((function(){return"horizontal"===t?(e=u.line().curve(u.curveMonotoneX),function(o,n){var t=Math.max(1,o.thickness-2*n)/2,i=.12*(o.target.x0-o.source.x1),r=[[o.source.x1,o.pos0-t],[o.source.x1+i,o.pos0-t],[o.target.x0-i,o.pos1-t],[o.target.x0,o.pos1-t],[o.target.x0,o.pos1+t],[o.target.x0-i,o.pos1+t],[o.source.x1+i,o.pos0+t],[o.source.x1,o.pos0+t],[o.source.x1,o.pos0-t]];return e(r)+"Z"}):function(){var e=u.line().curve(u.curveMonotoneY);return function(o,n){var t=Math.max(1,o.thickness-2*n)/2,i=.12*(o.target.y0-o.source.y1),r=[[o.pos0+t,o.source.y1],[o.pos0+t,o.source.y1+i],[o.pos1+t,o.target.y0-i],[o.pos1+t,o.target.y0],[o.pos1-t,o.target.y0],[o.pos1-t,o.target.y0-i],[o.pos0-t,o.source.y1+i],[o.pos0-t,o.source.y1],[o.pos0+t,o.source.y1]];return e(r)+"Z"}}();var e}),[t]);return l.jsx(l.Fragment,{children:o.map((function(e){return l.jsx(L,{link:e,layout:t,path:x(e,d),color:e.color,opacity:m(e),blendMode:s,enableGradient:c,setCurrent:h,isInteractive:y,onClick:f,tooltip:k},e.source.id+"."+e.target.id)}))})},B=function(e){var o=e.nodes,n=e.layout,i=e.width,r=e.height,a=e.labelPosition,d=e.labelPadding,s=e.labelOrientation,u=e.getLabelTextColor,h=t.useTheme(),p="vertical"===s?-90:0,v=o.map((function(e){var o,t,l;return"horizontal"===n?(t=e.y+e.height/2,e.x<i/2?"inside"===a?(o=e.x1+d,l="vertical"===s?"middle":"start"):(o=e.x-d,l="vertical"===s?"middle":"end"):"inside"===a?(o=e.x-d,l="vertical"===s?"middle":"end"):(o=e.x1+d,l="vertical"===s?"middle":"start")):"vertical"===n&&(o=e.x+e.width/2,e.y<r/2?"inside"===a?(t=e.y1+d,l="vertical"===s?"end":"middle"):(t=e.y-d,l="vertical"===s?"start":"middle"):"inside"===a?(t=e.y-d,l="vertical"===s?"start":"middle"):(t=e.y1+d,l="vertical"===s?"end":"middle")),{id:e.id,label:e.label,x:o,y:t,textAnchor:l,color:u(e)}})),y=t.useMotionConfig(),f=y.animate,k=y.config,m=c.useSprings(v.length,v.map((function(e){return{transform:"translate("+e.x+", "+e.y+") rotate("+p+")",color:e.color,config:k,immediate:!f}})));return l.jsx(l.Fragment,{children:m.map((function(e,o){var n=v[o];return l.jsx(c.animated.text,{dominantBaseline:"central",textAnchor:n.textAnchor,transform:e.transform,style:g({},h.labels.text,{fill:e.color,pointerEvents:"none"}),children:n.label},n.id)}))})},w=["isInteractive","animate","motionConfig","theme","renderWrapper"],I=function(e){var o=e.data,r=e.valueFormat,a=e.layout,d=void 0===a?x.layout:a,s=e.sort,c=void 0===s?x.sort:s,u=e.align,h=void 0===u?x.align:u,v=e.width,y=e.height,f=e.margin,k=e.colors,m=void 0===k?x.colors:k,b=e.nodeThickness,O=void 0===b?x.nodeThickness:b,M=e.nodeSpacing,L=void 0===M?x.nodeThickness:M,w=e.nodeInnerPadding,I=void 0===w?x.nodeInnerPadding:w,P=e.nodeBorderColor,H=void 0===P?x.nodeBorderColor:P,S=e.nodeOpacity,W=void 0===S?x.nodeOpacity:S,F=e.nodeHoverOpacity,q=void 0===F?x.nodeHoverOpacity:F,N=e.nodeHoverOthersOpacity,R=void 0===N?x.nodeHoverOthersOpacity:N,E=e.nodeBorderWidth,A=void 0===E?x.nodeBorderWidth:E,D=e.nodeBorderRadius,z=void 0===D?x.nodeBorderRadius:D,G=e.linkOpacity,V=void 0===G?x.linkOpacity:G,Z=e.linkHoverOpacity,_=void 0===Z?x.linkHoverOpacity:Z,J=e.linkHoverOthersOpacity,K=void 0===J?x.linkHoverOthersOpacity:J,U=e.linkContract,X=void 0===U?x.linkContract:U,Y=e.linkBlendMode,Q=void 0===Y?x.linkBlendMode:Y,$=e.enableLinkGradient,ee=void 0===$?x.enableLinkGradient:$,oe=e.enableLabels,ne=void 0===oe?x.enableLabels:oe,te=e.labelPosition,ie=void 0===te?x.labelPosition:te,re=e.labelPadding,ae=void 0===re?x.labelPadding:re,le=e.labelOrientation,de=void 0===le?x.labelOrientation:le,se=e.label,ce=void 0===se?x.label:se,ue=e.labelTextColor,he=void 0===ue?x.labelTextColor:ue,pe=e.nodeTooltip,ve=void 0===pe?x.nodeTooltip:pe,ge=e.linkTooltip,ye=void 0===ge?x.linkTooltip:ge,fe=e.isInteractive,ke=void 0===fe?x.isInteractive:fe,me=e.onClick,xe=e.legends,be=void 0===xe?x.legends:xe,Ce=e.layers,Oe=void 0===Ce?x.layers:Ce,je=e.role,Me=void 0===je?x.role:je,Le=e.ariaLabel,Te=e.ariaLabelledBy,Be=e.ariaDescribedBy,we=t.useDimensions(v,y,f),Ie=we.margin,Pe=we.innerWidth,He=we.innerHeight,Se=we.outerWidth,We=we.outerHeight,Fe=C({data:o,valueFormat:r,layout:d,width:Pe,height:He,sort:c,align:h,colors:m,nodeThickness:O,nodeSpacing:L,nodeInnerPadding:I,nodeBorderColor:H,label:ce,labelTextColor:he}),qe=Fe.nodes,Ne=Fe.links,Re=Fe.legendData,Ee=Fe.getNodeBorderColor,Ae=Fe.currentNode,De=Fe.setCurrentNode,ze=Fe.currentLink,Ge=Fe.setCurrentLink,Ve=Fe.getLabelTextColor,Ze=function(){return!1},_e=function(){return!1};if(ze&&(Ze=function(e){var o=e.id;return o===ze.source.id||o===ze.target.id},_e=function(e){var o=e.source,n=e.target;return o.id===ze.source.id&&n.id===ze.target.id}),Ae){var Je=[Ae.id];Ne.filter((function(e){var o=e.source,n=e.target;return o.id===Ae.id||n.id===Ae.id})).forEach((function(e){var o=e.source,n=e.target;Je.push(o.id),Je.push(n.id)})),Je=p.default(Je),Ze=function(e){var o=e.id;return Je.includes(o)},_e=function(e){var o=e.source,n=e.target;return o.id===Ae.id||n.id===Ae.id}}var Ke={links:Ne,nodes:qe,margin:Ie,width:v,height:y,outerWidth:Se,outerHeight:We},Ue={links:null,nodes:null,labels:null,legends:null};return Oe.includes("links")&&(Ue.links=l.jsx(T,{links:Ne,layout:d,linkContract:X,linkOpacity:V,linkHoverOpacity:_,linkHoverOthersOpacity:K,linkBlendMode:Q,enableLinkGradient:ee,setCurrentLink:Ge,currentNode:Ae,currentLink:ze,isCurrentLink:_e,isInteractive:ke,onClick:me,tooltip:ye},"links")),Oe.includes("nodes")&&(Ue.nodes=l.jsx(j,{nodes:qe,nodeOpacity:W,nodeHoverOpacity:q,nodeHoverOthersOpacity:R,borderWidth:A,borderRadius:z,getBorderColor:Ee,setCurrentNode:De,currentNode:Ae,currentLink:ze,isCurrentNode:Ze,isInteractive:ke,onClick:me,tooltip:ve},"nodes")),Oe.includes("labels")&&ne&&(Ue.labels=l.jsx(B,{nodes:qe,layout:d,width:Pe,height:He,labelPosition:ie,labelPadding:ae,labelOrientation:de,getLabelTextColor:Ve},"labels")),Oe.includes("legends")&&(Ue.legends=l.jsx(n.Fragment,{children:be.map((function(e,o){return l.jsx(i.BoxLegendSvg,g({},e,{containerWidth:Pe,containerHeight:He,data:Re}),"legend"+o)}))},"legends")),l.jsx(t.SvgWrapper,{width:Se,height:We,margin:Ie,role:Me,ariaLabel:Le,ariaLabelledBy:Te,ariaDescribedBy:Be,children:Oe.map((function(e,o){var t;return"function"==typeof e?l.jsx(n.Fragment,{children:n.createElement(e,Ke)},o):null!=(t=null==Ue?void 0:Ue[e])?t:null}))})},P=function(e){var o=e.isInteractive,n=void 0===o?x.isInteractive:o,i=e.animate,r=void 0===i?x.animate:i,a=e.motionConfig,d=void 0===a?x.motionConfig:a,s=e.theme,c=e.renderWrapper,u=function(e,o){if(null==e)return{};var n,t,i={},r=Object.keys(e);for(t=0;t<r.length;t++)n=r[t],o.indexOf(n)>=0||(i[n]=e[n]);return i}(e,w);return l.jsx(t.Container,{animate:r,isInteractive:n,motionConfig:d,renderWrapper:c,theme:s,children:l.jsx(I,g({isInteractive:n},u))})};e.ResponsiveSankey=function(e){return l.jsx(t.ResponsiveWrapper,{children:function(o){var n=o.width,t=o.height;return l.jsx(P,g({width:n,height:t},e))}})},e.Sankey=P,e.sankeyAlignmentFromProp=m,e.sankeyAlignmentPropKeys=k,e.sankeyAlignmentPropMapping=f,e.svgDefaultProps=x,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=nivo-sankey.umd.js.map
